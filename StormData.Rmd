---
title: "COURSERA PROJECT 2: Health and Economic Impacts of US Storm Weather"
output: html_document
date: "2024-10-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Synopsis
========
In this project, the storm database from the US National Weather service was analyzed with the goal of determining which event had done the most harm to population health and the economy. Our analysis on Fatalities and Injuries, collated as Heath statistics, conclude that the **Tornado** is the most harmful event in respect to population health. While, based on Property and Crop damages, the data showed that **Floods** had the greatest economic impact, with total damage costs reaching billions of dollars.

Data Processing
===============
The data was first extracted from a zip file into csv format.  
The csv file is then loaded into Rstudio from a preset working directory. 
```{r}
setwd("/Users/DrEmmanuelMeribole/Downloads/R code and analyses")
StormData1<-read.csv("repdata_data_StormData.csv", stringsAsFactors = T)
summary(StormData1)
```

**1. Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?**

The parameter used to describe harm to the health of the population would be the sum of the fatalities and Injuries. This involves the creation of a new column, called Health Statistics.  
That is, HealthStats= Fatalities + Injuries
```{r}
StormData1$HealthStats<- StormData1$FATALITIES + StormData1$INJURIES
```

Summarize HealthStats by EVTYPE

Since we’re interested in the “most” harmful, the focus would be on the health statistics related to the event type.
A Data frame will be generated displaying the total health impact by event.
Then we will get the Top 10 events with the most harm to population health.
```{r}
# Total health impact by event
library(dplyr)
EVhealthStats<- StormData1 %>% group_by(EVTYPE) %>% 
    summarise( HealthStats = sum(HealthStats, na.rm = TRUE)) 
EVhealthStats <- arrange(EVhealthStats, desc(HealthStats))
Top10health<- head(EVhealthStats, 10)
print(Top10health)
```

The Top10health data frame above shows the top 10 event types with the highest impact on population health.

**2. Across the United States, which types of events have the greatest economic consequences? **.  
The economic consequences of the storm events can be summarized by the property damage and crop damage columns, i.e: PROPDMG and CROPDMG.  
These columns have multipliers called PROPDMGEXP and CROPDMGEXP, with variables like "K", "M", and "B" translating to a multiple of a thousand, a million and a billion respectively.  
These multipliers would be applied to the property and crop damage columns, for a complete view of the cost of damages.

```{r}
library(stringr)
#Property Damage
StormData1$PROPDMGEXP <- str_replace(StormData1$PROPDMGEXP, "K", "1000")
StormData1$PROPDMGEXP <- str_replace(StormData1$PROPDMGEXP, "M", "1000000") 
StormData1$PROPDMGEXP <- str_replace(StormData1$PROPDMGEXP, "B", "1000000000")
#applying the multipliers
StormData1$PROPDMG <- StormData1$PROPDMG * as.numeric(StormData1$PROPDMGEXP)

# Crop damage
StormData1$CROPDMGEXP <- str_replace(StormData1$CROPDMGEXP, "k", "1000")
StormData1$CROPDMGEXP <- str_replace(StormData1$CROPDMGEXP, "K", "1000")
StormData1$CROPDMGEXP <- str_replace(StormData1$CROPDMGEXP, "m", "1000000") 
StormData1$CROPDMGEXP <- str_replace(StormData1$CROPDMGEXP, "M", "1000000") 
StormData1$CROPDMGEXP <- str_replace(StormData1$CROPDMGEXP, "B", "1000000000")
#applying the multipliers
StormData1$CROPDMG<- StormData1$CROPDMG * as.numeric(StormData1$CROPDMGEXP)
```
Total economic impact would now be the sum of property and crop damage, and this sum(Economic Impact, aka EconImpact) would be grouped according to the event type. 
```{r}
StormData1$EconImpact<- StormData1$PROPDMG + StormData1$CROPDMG

EVEconImpact<- StormData1 %>% group_by(EVTYPE) %>% 
    summarise( EconImpact = sum(EconImpact, na.rm = TRUE)) 
EVEconImpact <- arrange(EVEconImpact, desc(EconImpact))
Top10Econ<- head(EVEconImpact, 10)
print(Top10Econ)
```

The Top10Econ data frame above shows the top 10 event types with the highest economic impact. 

RESULTS
=======

**1. Answer to Question 1: Events that are most harmful with respect to population health**

To answer this,The top 10 harmful events will be visually represented on a bar chart.  
```{r}
library(ggplot2)
ggplot(Top10health, aes(EVTYPE, HealthStats)) + 
    geom_bar(stat = "identity") + 
  theme(axis.text.x = element_text(angle = 45, hjust=1)) + 
    xlab("") +
    ylab("population health stats") +
    ggtitle("Top 10 events impacting population health")
```

From the bar chart above, we can see the events that have caused the most harm to the population and can infer that the most impactful event is the Tornado. 

**2. Answer to Question 2: Events that have the greatest economic consequences**

```{r} 
library(ggplot2)
ggplot(Top10Econ, aes(EVTYPE, y=EconImpact/1e9)) + 
    geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 45, hjust=1)) + 
    xlab("") +
    ylab("Damage Costs(in billion USD)") +
    ggtitle("Top 10 events with highest economic impact")
```

From the chart above, we can infer that the highest economic impact is dealt by floods.
































